const sample=[{text:"Apixaban",color:"#ff7800",reaction:"a"},{text:"Rosuvastatin",color:"#ffd6ab",reaction:"b"},{text:"Company",color:"#ff7800",reaction:"c"},{text:"Apixaban",color:"#ffd6ab",reaction:"a"},{text:"Rosuvastatin",color:"#ff7800",reaction:"b"},{text:"Company",color:"#ffd6ab",reaction:"c"}],wheel=document.querySelector(".deal-wheel"),spinner=wheel.querySelector(".spinner"),ticker=wheel.querySelector(".ticker"),trigger=document.querySelector("#btn-spin"),spinClass="is-spinning",selectedClass="selected",spinnerStyles=window.getComputedStyle(spinner);let tickerAnim,prizeNodes,prizeSlice=360,prizeOffset=180,sound=new Audio("/assets/sounds/ding.mp3"),rotation=0,currentSlice=0;const createPrizeNodes=e=>{spinner.innerHTML="",e.forEach((({text:e,color:t,reaction:r},n)=>{const o=prizeSlice*n*-1-prizeOffset;spinner.insertAdjacentHTML("beforeend",`<li class="prize" data-text="${e}" data-color="${t}" data-reaction=${r} style="--rotate: ${o}deg">\n        <span class="text">${e}</span>\n      </li>`)}))},createConicGradient=e=>{spinner.setAttribute("style",`background: conic-gradient(\n      from -90deg,\n      ${e.map((({color:t},r)=>`${t} 0 ${100/e.length*(e.length-r)}%`)).reverse()}\n    );`)},setupWheel=e=>{prizeSlice=360/e.length,prizeOffset=Math.floor(180/e.length),createConicGradient(e),createPrizeNodes(e),prizeNodes=wheel.querySelectorAll(".prize")},spinertia=(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),runTickerAnimation=()=>{const e=spinnerStyles.transform.split("(")[1].split(")")[0].split(","),t=e[0],r=e[1];let n=Math.atan2(r,t);n<0&&(n+=2*Math.PI);const o=Math.round(n*(180/Math.PI)),i=Math.floor(o/prizeSlice);currentSlice!==i&&(ticker.style.animation="none",setTimeout((()=>ticker.style.animation=null),10),currentSlice=i,sound.pause(),sound.currentTime=0,sound.play()),tickerAnim=requestAnimationFrame(runTickerAnimation)},selectPrize=()=>{const e=Math.floor(rotation/prizeSlice);prizeNodes[e].classList.add("selected"),document.querySelector(".pop-up-content-wrap span").innerHTML=prizeNodes[e].getAttribute("data-text"),document.querySelector(".custom-model-wrap").style.background=prizeNodes[e].getAttribute("data-color"),document.querySelector(".custom-model-main").classList.add("model-open")};trigger.addEventListener("click",(()=>{var e,t;trigger.disabled=!0,rotation=Math.floor(360*Math.random()+(e=2e3,t=5e3,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e)),prizeNodes.forEach((e=>e.classList.remove("selected"))),wheel.classList.add(spinClass),spinner.style.setProperty("--rotate",rotation),ticker.style.animation="none",runTickerAnimation()})),spinner.addEventListener("transitionend",(()=>{cancelAnimationFrame(tickerAnim),trigger.disabled=!1,trigger.focus(),rotation%=360,selectPrize(),wheel.classList.remove(spinClass),spinner.style.setProperty("--rotate",rotation)})),document.querySelector(".custom-model-main").addEventListener("click",(()=>{document.querySelector(".custom-model-main").classList.remove("model-open")})),setupWheel(sample);